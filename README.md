# War3ExcelTool ğŸ› ï¸

## é¡¹ç›®ç®€ä»‹

War3ExcelTool æ˜¯æ‰¹é‡å¤„ç†é­”å…½è¡¨æ ¼çš„å·¥å…·ï¼Œèƒ½å¤Ÿå°† Excel è¡¨æ ¼æ•°æ®æ‰¹é‡è½¬æ¢ä¸º typescriptã€luaã€ini ã€json æ–‡ä»¶ï¼Œä¹Ÿèƒ½å¤Ÿå°†ç‰©ç¼– ini æ–‡ä»¶è½¬æ¢ä¸º Excel æ–‡ä»¶ã€‚

## ä»“åº“åœ°å€

[giteeï¼š]()
[githubï¼š]()

## å®‰è£…æ–¹æ³•

ä¸‹è½½ release çš„å‹ç¼©åŒ…

## å¿«é€Ÿå¼€å§‹ ğŸš€

ç™½æ³½æ¡†æ¶è§£å‹å°±èƒ½ä½¿ç”¨

- **å‘½ä»¤è¡Œæ¨¡å¼**
  é…ç½® vscode ä»»åŠ¡ï¼š

  ```json
  {
    "version": "2.0.0",
    "tasks": [
      {
        "label": "è¿è¡Œ main(å‘½ä»¤è¡Œæ¨¡å¼)",
        "type": "shell",
        "command": "python",
        "args": [
          "src/main.py",
          "-i",
          "else/Test/input", // ç»Ÿä¸€ä½¿ç”¨æ­£æ–œæ é¿å…è½¬ä¹‰é—®é¢˜
          "-o",
          "else/Test", // å«ç©ºæ ¼è·¯å¾„å¿…é¡»ç”¨åŒå¼•å·åŒ…è£¹
          "--ini-output", //iniæ–‡ä»¶è·¯å¾„
          "else/Test/initest"
        ],
        "options": {
          "cwd": "${workspaceFolder}"
        },
        "problemMatcher": [],
        "group": {
          "kind": "build",
          "isDefault": true
        }
      }
    ]
  }
  ```

- **GUI æ¨¡å¼**

  è¿è¡Œç¨‹åºåï¼Œä¼šå¼¹å‡º GUI ç•Œé¢ï¼Œé€‰æ‹©éœ€è¦çš„åŠŸèƒ½ï¼Œç‚¹å‡»è½¬æ¢æŒ‰é’®å³å¯ã€‚

---

## æ‰“åŒ…ä¸ºå¯æ‰§è¡Œæ–‡ä»¶

å¦‚æœè¦å°†ç¨‹åºæ‰“åŒ…ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥è¿è¡Œï¼š

```
python build.py
```

## åŠŸèƒ½è¯¦è§£ ğŸ§ 

### **æ‰¹é‡å¤„ç†**

æ”¯æŒæ‰¹é‡å¤„ç†å¤šä¸ª Excel æ–‡ä»¶ï¼Œæ”¯æŒä»¥ä¸‹æ ¼å¼ï¼š`.xls, .xlsx, .xlsm, .xlsb, .odf, .ods, .odt`

---

### **Excel æ–‡ä»¶è§£æåŠŸèƒ½**

1.  excel è¡¨æ ¼ç¬¬ä¸€è¡Œä¸ºæ³¨é‡Šè¡Œï¼Œä¸å†™å…¥ç”Ÿæˆçš„æ–‡ä»¶ä¸­ï¼›ç¬¬äºŒè¡Œæ˜¯ key å€¼ï¼Œä½œä¸ºç”Ÿæˆå¯¹è±¡çš„é”®ï¼Œç¬¬ä¸‰è¡Œå¼€å§‹æ˜¯æ•°æ®è¡Œ

2.  key å€¼ä¸ºç©ºçš„åˆ—ä¸è§£æï¼›id ä¸ºç©ºæˆ–ä»¥//å¼€å¤´çš„è¡Œä¸è§£æï¼Œé»˜è®¤æ³¨é‡Šè¡Œ
    ![img](resource\README\test2.png)

3.  è‡ªåŠ¨è¯†åˆ«å•å…ƒæ ¼æ•°æ®ç±»å‹ï¼Œts è¯†åˆ«æˆ numberã€stringã€booleanã€any

4.  æ”¯æŒå­—ç¬¦çº§é¢œè‰²è¯†åˆ«ï¼Œéœ€æ³¨æ„ï¼šæœ‰é¢œè‰²è¯†åˆ«çš„åˆ—è¦åŠ ä¸Šé¢„å¤„ç†æŒ‡ä»¤(#color)
    ![img](resource\README\test4.png)

5.  ä¸æ­£ç¡®çš„ war3 è·¯å¾„æ ¼å¼è‡ªåŠ¨ä¿®æ”¹ `å¦‚ï¼ša\c\\b\\\\\s.blp ä¿®æ”¹ä¸º a\\c\\b\\s.blp`

6.  æ”¯æŒç§‘å­¦è®¡æ•°æ³• `1,234,567.89e+6`ï¼Œå¯ä»¥ç”¨è‹±æ–‡é€—å·','

7.  æ”¯æŒå¯¹è±¡ã€æ•°ç»„ã€å¸ƒå°”å€¼ã€æ•°å­—ã€å­—ç¬¦ä¸²ï¼Œå¸ƒå°”å€¼å¤§å†™å°å†™éƒ½è¡Œ(true/false)

8.  é¢„å¤„ç†æŒ‡ä»¤

- (#color) é¢œè‰²è¯†åˆ«
- (#default bbb) è®¾ç½®é»˜è®¤å€¼ï¼Œè¯¥åˆ—ç©ºçš„å•å…ƒæ ¼çš„å€¼è®¾ç½®ä¸º bbb
  ![img](resource\README\test5.png)
  `"default": "bbb",`

---

### **ç™½æ³½æ¡†æ¶è¯´æ˜**

- ç™½æ³½æ¡†æ¶ç‰©ç¼–è¡¨æ ¼ï¼šåä¸º table çš„ excel æ–‡ä»¶ï¼Œsheet åä¸º `unitã€ abilityã€item`è¡¨æ ¼

  - **unit**

    å•ä½ idï¼š`h004`å¼€å§‹ï¼Œä¾æ¬¡é€’å¢
    æ³¨æ„ï¼š`acquire=0`æ—¶ï¼Œç‰©ç¼–ä¼šå†™å…¥ `weapsOn=0`ï¼Œå³å•ä½ä¸èƒ½æ”»å‡»
    ![img](resource\README\test8.png)

  - **ability**

  X/Y/Z+ç©å®¶åºå·+æŠ€èƒ½æŒ‰é’® x åæ ‡+æŠ€èƒ½æŒ‰é’® y åæ ‡
  id ç¬¬ 1 ä½ï¼šæ— ç›®æ ‡ä¸º Xï¼Œå•ä½ç›®æ ‡ä¸º Yï¼Œç‚¹ç›®æ ‡ä¸º Z
  id ç¬¬ 2 ä½ï¼šç©å®¶åºå·ï¼šp
  id ç¬¬ 3 ä½ï¼šæŠ€èƒ½æŒ‰é’®ä½ç½® x åæ ‡ï¼šx:0-3ï¼Œ4 åˆ—
  id ç¬¬ 4 ä½ï¼šæŠ€èƒ½æŒ‰é’®ä½ç½® y åæ ‡ï¼šy:0-2ï¼Œ3 è¡Œ
  id=X/Y/Z+p+x+y

  - **item**

  ç‰©å“ idï¼š`I004`å¼€å§‹ï¼Œä¾æ¬¡é€’å¢
  ç‰©å“æŠ€èƒ½ idï¼š`A004`å¼€å§‹ï¼Œä¾æ¬¡é€’å¢

- ç”Ÿæˆåå­—ä¸ç‰©ç¼– id åŒå‘æ˜ å°„çš„ ts æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š

  ```ts
  export const UnitId = {
    test: "h006",
    h006: "test",
    å†°é›ªæ³•å¸ˆ: "h008",
    h008: "å†°é›ªæ³•å¸ˆ",
    å‰‘åœ£: "h007",
    h007: "å‰‘åœ£",
    åŠ©æ‰‹: "h004",
    h004: "åŠ©æ‰‹",
    å•ä½: "h005",
    h005: "å•ä½",
  } as const;
  ```

### **Excel è½¬ ts**

code åˆ—å¯ä»¥å†™ä»£ç ï¼Œimport æ”¾åœ¨ ts æ–‡ä»¶æœ€å‰é¢ï¼Œå…¶ä»–æ”¾åœ¨ Start å‡½æ•°å†…

### **Excel è½¬ lua**

### **Excel è½¬ json**

---

### **Excel è½¬ ini**

- **ç‰©ç¼–è¡¨æ ¼**
  åªæœ‰è¢«è¯†åˆ«æˆç‰©ç¼–è¡¨æ ¼çš„ excel æ–‡ä»¶çš„ sheet æ‰ä¼šç”Ÿæˆ ini æ–‡ä»¶ï¼Œè¯†åˆ«è§„åˆ™ï¼š

  1. ç™½æ³½æ¡†æ¶ç‰©ç¼–è¡¨æ ¼
     ![img](resource\README\test6.png)
  2. é€šç”¨ç‰©ç¼–è¡¨æ ¼ï¼šexcel æ–‡ä»¶åæ— è¦æ±‚ï¼Œsheet åç¬¬äºŒè¡Œ key å€¼åŒ…æ‹¬ `idå’Œ_parent`çš„è¡¨æ ¼
     ![img](resource\README\test7.png)
  3. å¦‚æœç‰©ç¼– id é‡å¤ä½¿ç”¨ï¼Œä¼šè¯¦ç»†æŒ‡å‡ºå“ªä¸ª excel æ–‡ä»¶ï¼Œå“ªä¸ª sheetï¼Œå“ªä¸€è¡Œé‡å¤äº†

- **war3ini æ ¼å¼**
  éœ€è¦æ³¨æ„ war3ini çš„æ ¼å¼ï¼š`{1,2,3}`ï¼šä¸­æ‹¬å·å†…ç”¨é€—å·é—´éš”ï¼šè¡¨ç¤ºå¤šä¸ªç­‰çº§çš„æ•°æ®ï¼Œ`[=[...]=]`ï¼šä»¥ `[=[`å¼€å¤´ï¼Œä»¥ `]=]`ç»“å°¾è¡¨ç¤ºå¤šè¡Œå­—ç¬¦ä¸²

---

### é…ç½®ç®¡ç† âš™ï¸

é…ç½®æ–‡ä»¶æ ¼å¼ä¸º`.cfg`ï¼ŒåŒ…å«ä»¥ä¸‹é…ç½®é¡¹ï¼š

- **è·¯å¾„å‚æ•°**

  - `input_path` ï¼šè¾“å…¥è·¯å¾„
  - `output_path` ï¼šè¾“å‡ºè·¯å¾„
  - `w3x2lni_path` ï¼šw3x2lni å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ï¼Œå¼€å¯ w3x è§£æåŠŸèƒ½æ—¶å¿…é¡»é…ç½®

- **åŠŸèƒ½å‚æ•°**

  - `convert_to_ts` ï¼šæ˜¯å¦å¼€å¯ Excel åˆ° TypeScript åŠŸèƒ½
  - `convert_to_lua` ï¼šæ˜¯å¦å¼€å¯ Excel åˆ° Lua åŠŸèƒ½
  - `convert_to_json` ï¼šæ˜¯å¦å¼€å¯ Excel åˆ° JSON åŠŸèƒ½
  - `convert_to_ini` ï¼šæ˜¯å¦å¼€å¯ Excel åˆ° INI åŠŸèƒ½
  - `ini_output` ï¼šini æ–‡ä»¶è·¯å¾„ï¼Œä¼šé¢å¤–å°†å¯¼å‡ºçš„ ini æ–‡ä»¶å¤åˆ¶åˆ°æ­¤è·¯å¾„ä¸‹ï¼Œä»…åœ¨ convert_to_ini ä¸º true æ—¶æœ‰æ•ˆ
  - `convert_ini_to_excel` ï¼šæ˜¯å¦å¼€å¯ INI åˆ° Excel åŠŸèƒ½
  - `parse_w3x` ï¼šæ˜¯å¦å¼€å¯ w3x è§£æåŠŸèƒ½

- **è¾…åŠ©å‚æ•°**
  - `baize_frame` ï¼šæ˜¯å¦å¯ç”¨ç™½æ³½æ¡†æ¶ï¼Œé»˜è®¤ï¼šTrue
  - `player_count` ï¼šç™½æ³½æ¡†æ¶ï¼Œç©å®¶æ•°é‡ï¼Œå½±å“åŸºç¡€æŠ€èƒ½ç‰©ç¼–æ•°é‡ï¼Œé»˜è®¤ï¼š5
  - `recursive` ï¼šæ˜¯å¦é€’å½’å¤„ç†è¾“å…¥ç›®å½•ï¼Œé»˜è®¤ï¼šTrue
  - `log_level` ï¼šæ—¥å¿—çº§åˆ«ï¼ˆDEBUG/INFO/WARNING/ERROR/CRITICALï¼‰ï¼Œé»˜è®¤ï¼šINFO
  - `sort_by_alpha` ï¼šç”Ÿæˆè¡¨æ ¼æ˜¯å¦æŒ‰å­—æ¯æ’åºï¼Œé»˜è®¤ï¼šFalse
  - `font_size` ï¼šExcel å¯¼å‡ºå­—ä½“å¤§å°ï¼Œé»˜è®¤ï¼š14
  - `remove_empty_columns` ï¼šç”Ÿæˆ Excel æ—¶åˆ é™¤å…¨ç©ºåˆ—ï¼Œé»˜è®¤ï¼šTrue

### å‘½ä»¤è¡Œå‚æ•°

- `-i, --input`ï¼šè¾“å…¥ç›®å½•æˆ–æ–‡ä»¶ï¼Œå¿…é¡»è®¾ç½®
- `-o, --output`ï¼šè¾“å‡ºç›®å½•ï¼Œå¿…é¡»è®¾ç½®
- `--ini-output`ï¼š ini æ–‡ä»¶è·¯å¾„ï¼ˆå¯ä¸è®¾ç½®ï¼‰

---

## åŠŸèƒ½æ¼”ç¤º

![excelæµ‹è¯•æ•°æ®](resource\README\test_excel.png)

```ts
export const xlsx_inte_keys_test_Sheet1 = [
  "id",
  "str",
  "icon",
  "num",
  "num1",
  "num2",
  "bool",
  "object",
  "array",
];

export interface xlsx_inte_test_Sheet1 {
  [key: string]: {
    id?: string; // è‡ªå®šä¹‰id
    str?: string; // å­—ç¬¦ä¸²
    icon?: number | string; // è·¯å¾„
    num?: number; // æ•°å­—1
    num1?: number; // æ•°å­—2
    num2?: number; // ç§‘å­¦è®¡æ•°æ³•
    bool?: boolean; // å¸ƒå°”å€¼
    object?: any; // å¯¹è±¡
    array?: any; // æ•°ç»„
  };
}

export const xlsx_data_test_Sheet1: xlsx_inte_test_Sheet1 = {
  æµ‹è¯•id4: {
    id: "æµ‹è¯•id4",
    str: "å­—|cffff0000ç¬¦ä¸²|ræµ‹|cff00b050è¯•1a|raaa|cff00b0f0bbbb|rcc|cffffc000ccd|rddd",
    icon: "a\\c\\b\\s.blp",
    num: 138,
    num1: -58.049,
    num2: 1234567.89e6,
    bool: false,
    object: { é˜²å¾¡: 2785, æ³•æŠ—: 58118 },
    array: [85, 13, 599],
  },
};
export class xlsx_test_Sheet1 {
  static Start() {
    const data = xlsx_data_test_Sheet1;
    for (let datum of data) {
      if (datum.id) {
        ActorTypeUtil.registerActorType(datum as any);
      }
    }
  }
}
```
