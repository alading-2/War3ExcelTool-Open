## War3Excel 工具项目简介

这是一个强大的 War3Excel 工具，能够将 Excel 表格数据自动批量转换为 TypeScript、Lua、Ini 文件，也能够将 Ini 文件转换为 Excel 文件。

## 主要功能

- **Excel 解析**：自动解析 Excel 文件，根据指定规则提取数据
- **类型推断**：自动判断数据类型，支持 number、string、boolean 和复杂类型
- **代码生成**：生成符合规范的 TypeScript 接口和类
- **批量处理**：支持批量处理多个 Excel 文件
- **图形界面**：提供友好的用户界面，便于操作
- **多工作表支持**：支持处理包含多个工作表的 Excel 文件
- **JSON 配置**：使用 JSON 文件进行配置，简化命令行参数

## 新增功能

### w3x 解析功能

War3ExcelTool 现在支持解析魔兽争霸 3 地图文件(w3x)，使用 w3x2lni 工具提取地图数据，包括：

- 单位数据
- 物品数据
- 技能数据
- buff 数据
- 可破坏物数据
- 科技数据

### 配置改进

- 配置文件格式从.json 改为.cfg
- 新增配置项：
  - `ini_output`：生成 ini 文件的路径
  - `w3x2lni_path`：w3x2lni 工具路径
  - `parse_w3x`：是否解析 w3x 文件
  - `sort_by_alpha`：生成表格是否按字母排序（默认 False）
  - `font_size`：字体大小（默认 14）

## 安装方法

### 安装依赖

1. 下载最新的安装包
2. 运行安装程序，按照提示进行安装
3. 安装完成后，从开始菜单或桌面快捷方式启动程序

### 从源码安装

1. 克隆仓库：

   ```
   git clone https://github.com/yourusername/excel-to-ts.git
   cd excel-to-ts
   ```

2. 安装依赖：

   ```
   pip install -r requirements.txt
   ```

### 运行程序

```bash
# 命令行模式
python -m src.main -i /path/to/input -o /path/to/output

# GUI模式
python -m src.main
```

### 打包为可执行文件

如果要将程序打包为可执行文件，可以运行：

```
python build.py
```

打包过程有以下特点：

- 自动检查并关闭正在运行的 ExcelToTS.exe 程序
- 打包完成后自动打开新生成的可执行文件

## 使用方法

### 图形界面

1. 启动程序
2. 选择包含 Excel 文件的输入目录
3. 选择 TypeScript 文件的输出目录
4. 勾选"递归处理子目录"选项（如果需要）
5. 点击"开始转换"按钮
6. 转换过程将在操作日志中显示

### 命令行

程序支持命令行操作：

```bash
python src.main -i /path/to/input -o /path/to/output
```

参数说明：

- `-i, --input`：输入目录或文件
- `-o, --output`：输出目录

### 配置文件

配置文件使用 JSON 格式，默认位于`src/setting.json`。主要配置项包括：

```json
{
  "convert_to_ts": true,
  "convert_to_lua": false,
  "convert_to_ini": false,
  "convert_ini_to_excel": false,
  "recursive": true,
  "log_level": "INFO",
  "baize_frame": true
}
```

## Excel 文件格式要求

为了正确转换，Excel 文件需要符合以下格式：

1. 第一行作为注释
2. 第二行作为数据的 key 值
3. 第三行及以下为实际数据
4. 忽略首列为"//"的行
5. 空数据单元格不会被提取

## 生成的 TypeScript 代码

假设 Excel 文件名为"item.xlsx"，生成的 TypeScript 文件将命名为"xlsx_item.ts"，包含：

1. 接口索引常量：`xlsx_inte_keys_item`
2. 接口定义：`xlsx_inte_item`
3. 数据常量：`xlsx_data_item`
4. 类定义：`xlsx_item`，包含 Start 方法

## 许可证

本项目采用 MIT 许可证。
