# Excel 到 TypeScript 转换工具

这是一个强大的 Python 工具，能够将 Excel 表格数据自动转换为 TypeScript 代码。本工具专为需要从 Excel 数据生成 TypeScript 代码的开发人员设计，支持类型推断和复杂数据结构。

## 主要功能

- **Excel 解析**：自动解析 Excel 文件，根据指定规则提取数据
- **类型推断**：自动判断数据类型，支持 number、string、boolean 和复杂类型
- **代码生成**：生成符合规范的 TypeScript 接口和类
- **批量处理**：支持批量处理多个 Excel 文件
- **图形界面**：提供友好的用户界面，便于操作
- **多工作表支持**：支持处理包含多个工作表的 Excel 文件
- **JSON 配置**：使用 JSON 文件进行配置，简化命令行参数

## 安装方法

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行程序

```bash
# 命令行模式
python -m src.main -i /path/to/input -o /path/to/output

# GUI模式
python -m src.main
```

## 使用方法

### 图形界面

1. 启动程序
2. 选择包含 Excel 文件的输入目录
3. 选择 TypeScript 文件的输出目录
4. 勾选"递归处理子目录"选项（如果需要）
5. 点击"开始转换"按钮
6. 转换过程将在操作日志中显示

### 命令行

程序支持命令行操作：

```bash
python -m src.main -i /path/to/input -o /path/to/output -c /path/to/config.json
```

参数说明：

- `-i, --input`：输入目录或文件
- `-o, --output`：输出目录
- `-c, --config`：(可选) 指定配置文件路径，默认使用`src/setting.json`

### 配置文件

配置文件使用 JSON 格式，默认位于`src/setting.json`。主要配置项包括：

```json
{
  "convert_to_ts": true,
  "convert_to_lua": false,
  "convert_to_ini": false,
  "convert_ini_to_excel": false,
  "recursive": true,
  "log_level": "INFO",
  "excel_header_row": 1,
  "excel_data_start_row": 2,
  "excel_comment_column": "A",
  "excel_key_column": "B",
  "excel_value_column": "C"
}
```

## Excel 文件格式要求

为了正确转换，Excel 文件需要符合以下格式：

1. 第一行作为注释
2. 第二行作为数据的 key 值
3. 第三行及以下为实际数据
4. 忽略首列为"//"的行
5. 空数据单元格不会被提取

## 生成的 TypeScript 代码

假设 Excel 文件名为"item.xlsx"，生成的 TypeScript 文件将命名为"xlsx_item.ts"，包含：

1. 接口索引常量：`xlsx_inte_keys_item`
2. 接口定义：`xlsx_inte_item`
3. 数据常量：`xlsx_data_item`
4. 类定义：`xlsx_item`，包含 Start 方法

## 许可证

本项目采用 MIT 许可证。
