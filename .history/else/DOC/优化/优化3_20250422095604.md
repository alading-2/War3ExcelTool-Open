项目信息记录

name：War3ExcelTool

version:"1.0.0"

author：阿拉丁

description：...

等等

程序中有多个地方需要调用这些信息，但是现在都是分开写的，一改就要改多个地方，我希望可以从一个地方写入，其他地方都从这里调用，不知道用什么方式实现比较好，请你以经验丰富的 python 程序员角度，深度思考后给出好的建议

作为一名有经验的 Python 工程师，我建议你将项目信息集中存放在一个专门的配置文件中，比如 project_info.py，用字典或 dataclass 统一管理。所有需要用到项目信息的地方都通过 import 这个配置文件来获取数据，避免重复维护和出错。如果有跨语言或自动化需求，可以再同步生成 JSON/YAML 等格式，供其他工具或文档引用。这样既保证了信息的一致性，也方便后期维护和扩展，是最简单高效的做法。

from dataclasses import dataclass, asdict
import json
import yaml
from typing import Dict, Any, Optional

@dataclass
class ProjectInfo:
"""项目信息类，集中存储项目的各种元数据"""
name: str = "War3ExcelTool"
version: str = "1.0.0"
author: str = "阿拉丁"
description: str = "Excel 转换工具" # 可以根据需要添加更多字段

    def to_dict(self) -> Dict[str, Any]:
        """将项目信息转换为字典格式"""
        return asdict(self)

    def to_json(self) -> str:
        """将项目信息转换为JSON字符串"""
        return json.dumps(self.to_dict(), ensure_ascii=False, indent=2)

    def to_yaml(self) -> str:
        """将项目信息转换为YAML字符串"""
        try:
            return yaml.dump(self.to_dict(), allow_unicode=True)
        except ImportError:
            print("警告: 未安装PyYAML库，无法导出YAML格式")
            return ""

    def save_to_file(self, file_path: str, format: str = "json") -> None:
        """
        将项目信息保存到文件

        参数:
            file_path: 文件保存路径
            format: 保存格式，支持 'json' 或 'yaml'
        """
        try:
            with open(file_path, 'w', encoding='utf-8') as f:
                if format.lower() == 'json':
                    f.write(self.to_json())
                elif format.lower() == 'yaml':
                    f.write(self.to_yaml())
                else:
                    raise ValueError(f"不支持的格式: {format}")
            print(f"项目信息已保存到: {file_path}")
        except Exception as e:
            print(f"保存项目信息时出错: {e}")

# 创建一个全局实例，方便导入

project_info = ProjectInfo()

# 示例: 如何在代码中使用

if **name** == "**main**": # 打印项目信息
print(f"项目名称: {project_info.name}")
print(f"版本: {project_info.version}")
print(f"作者: {project_info.author}")

    # 导出为不同格式
    print("\nJSON格式:")
    print(project_info.to_json())

    print("\nYAML格式:")
    print(project_info.to_yaml())

    # 保存到文件
    project_info.save_to_file("project_info.json")
    project_info.save_to_file("project_info.yaml", format="yaml")
