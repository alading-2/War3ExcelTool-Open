我需要将预处理 pretreatment 用在 data_handler 中，用 extract_preprocessor_directives 生成预处理规则字典，并且用 apply_column_preprocessors 对 dataframe 的值进行修改。

这些修改应该放在很前面，即 data_handler 中“检查 DataFrame 是否有足够的行”后面，“从第二行提取键名(列名)”前面，因为要去除预处理指令，否则从第二行提取键名(列名)的时候还保留。

同时帮我查看 pretreatment.py 有没有要修改的地方，比如：

1. df.iloc[row_idx][col_idx].replace(pattern, "").replace("\n","").strip()，这里我的意图是去除预处理指令，然后去除\n 再去除空格
2. apply_column_preprocessors 是通过预处理规则字典对 dataframe 的值进行修改
