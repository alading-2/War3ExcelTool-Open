PS E:\Vscode_Code\Python\ExcelToTypescript> & C:/Users/29701/AppData/Local/Programs/Python/Python313/python.exe e:/Vscode_Code/Python/ExcelToTypescript/else/PythonTest/pd_test.py
解析 Excel 文件的工作表时出错: 初始化 ExcelTable 时出
错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().Traceback (most recent call last):
File "E:\Vscode_Code\Python\ExcelToTypescript\src\core\data_handler.py", line 122, in **init**
self.\_data[2:] = self.\_data[2:].apply(excel_parser.\_value_handle)
~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\frame.py", line 10374, in apply
return op.apply().**finalize**(self, method="apply")
~~~~~~~~^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 916, in apply
return self.apply_standard()
~~~~~~~~~~~~~~~~~~~^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
results, res_index = self.apply_series_generator()
~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
results[i] = self.func(v, \*self.args, \*\*self.kwargs)
~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "E:\Vscode_Code\Python\ExcelToTypescript\src\core\excel_parser.py", line 366, in \_value_handle
type = self.infer_type_single(value)
File "E:\Vscode_Code\Python\ExcelToTypescript\src\core\excel_parser.py", line 230, in infer_type_single
if pd.isna(value): # 首先处理 Pandas 的 NA 值
~~~~~~~^^^^^^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\generic.py", line 1577, in**nonzero**
raise ValueError(
...<2 lines>...
)
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or
a.all().

Traceback (most recent call last):
File "E:\Vscode_Code\Python\ExcelToTypescript\src\core\data_handler.py", line 122, in **init**
self.\_data[2:] = self.\_data[2:].apply(excel_parser.\_value_handle)
~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\frame.py", line 10374, in apply
return op.apply().**finalize**(self, method="apply")
~~~~~~~~^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 916, in apply
return self.apply_standard()
~~~~~~~~~~~~~~~~~~~^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
results, res_index = self.apply_series_generator()
~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
results[i] = self.func(v, \*self.args, \*\*self.kwargs)
~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "E:\Vscode_Code\Python\ExcelToTypescript\src\core\excel_parser.py", line 366, in \_value_handle
type = self.infer_type_single(value)
File "E:\Vscode_Code\Python\ExcelToTypescript\src\core\excel_parser.py", line 230, in infer_type_single
if pd.isna(value): # 首先处理 Pandas 的 NA 值
~~~~~~~^^^^^^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\generic.py", line 1577, in**nonzero**
raise ValueError(
...<2 lines>...
)
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or
a.all().

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
File "e:\Vscode_Code\Python\ExcelToTypescript\else\PythonTest\pd_test.py", line 11, in `<module>`
results = excel_parser.parse_excel(file_path) File "E:\Vscode_Code\Python\ExcelToTypescript\src\core\excel_parser.py", line 79, in parse_excel excel_table = ExcelTable(df)
File "E:\Vscode_Code\Python\ExcelToTypescript\src\core\data_handler.py", line 144, in **init**
raise ValueError(error_msg)
ValueError: 初始化 ExcelTable 时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
File "E:\Vscode_Code\Python\ExcelToTypescript\src\core\data_handler.py", line 122, in**init**
self.\_data[2:] = self.\_data[2:].apply(excel_parser.\_value_handle)
~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\frame.py", line 10374, in apply
return op.apply().**finalize**(self, method="apply")
~~~~~~~~^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 916, in apply
return self.apply_standard()
~~~~~~~~~~~~~~~~~~~^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
results, res_index = self.apply_series_generator()
~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
results[i] = self.func(v, \*self.args, \*\*self.kwargs)
~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "E:\Vscode_Code\Python\ExcelToTypescript\src\core\excel_parser.py", line 366, in \_value_handle
type = self.infer_type_single(value)
File "E:\Vscode_Code\Python\ExcelToTypescript\src\core\excel_parser.py", line 230, in infer_type_single
if pd.isna(value): # 首先处理 Pandas 的 NA 值
~~~~~~~^^^^^^^
File "C:\Users\29701\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\generic.py", line 1577, in**nonzero**
raise ValueError(
...<2 lines>...
)
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or
a.all().
