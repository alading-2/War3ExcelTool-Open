1.main.py 优化，要求：分成两种运行模型：

- (1) 命令行运行，必须填入-i 和-o 参数，然后直接执行转化过程，不需要点击“开始转换“按钮。
- (2)直接启动 main.py，不需要判断命令行参数，用户可以用 ui 设置各种参数，然后点击“开始转换“按钮，开始转换。
- 2.现在需要新增功能：excel 数据转 lua、excel 数据转 ini，ini 转 excel 文件，这些具体功能先不实现，需要把大致框架先优化。这些功能最终都在 main_window.py 一起实现，

- 他们有共同之处，self.output_dir=os.path.join(self.output_dir, "output", "ts")，只需把 ts 换成 ts/lua/ini
- 如果同时勾选多个功能进行转换，将同时执行
- 都在 fori, file_pathinenumerate(excel_files):下一起执行

  3.框架修改：新加了不少参数和功能，要对项目需要修改的地方进行修改，比如 UI 界面要新建 excel 数据转 ts、lua、excel 数据转 ini，ini 转 excel 文件这几个功能的是否勾选按钮

核心优化点回顾:

1. 运行模式分离 ( main.py ): 支持纯命令行执行（带 -i 和 -o 参数，直接运行）和 GUI 交互执行（无参数，通过 UI 操作）。
2. 功能扩展: 新增 Excel -> Lua, Excel -> Ini, Ini -> Excel 转换功能（先搭框架）。
3. 框架调整: 修改 UI ( main_window.py ) 和相关模块以支持新功能，特别是添加功能选择的勾选框。

逻辑分离:

- 核心处理逻辑: 应将实际的文件查找、解析、转换和写入过程封装成一个独立的函数或类（例如在 src/core/processor.py 中定义一个 process_files(config) 函数）。这个函数接收一个包含所有配置（输入路径、输出路径、递归选项、要执行的转换类型标志等）的字典或对象。
- main.py 职责:
  - 使用 argparse 解析命令行参数。
  - 如果检测到命令行模式（例如存在 -i 和 -o ），则根据参数构建 config 对象，直接调用 process_files(config) ，然后退出。 不应 启动 Qt 应用。
  - 如果没有检测到命令行模式，则正常启动 Qt 应用 ( QApplication 和 `MainWindow` )。
- MainWindow 职责: 在用户点击“开始转换”时，从 UI 控件收集设置，构建 config 对象，传递给后台工作线程 ( ConversionWorker )。
- ConversionWorker 职责: 接收 config 对象，在其 run 方法中调用核心处理逻辑 process_files(config) 。

2. 新增功能 (Excel->Lua/Ini, Ini->Excel):

- Ini->Excel 的特殊性:
  - 输入源不同: 它处理 .ini 文件，不是 Excel。因此， `优化.md` 中提到的 “都在 for i, file_path in enumerate(excel_files):下一起执行” 不适用于 Ini->Excel 。它需要独立的逻辑来查找和处理 .ini 文件。
  - UI/命令行输入: 需要为 Ini 输入提供单独的选择方式（文件/目录浏览）。
- 输出结构:
  - `优化.md` 提到的 self.output_dir=os.path.join(self.output_dir, "output", "ts") 思路需要修正。正确的做法是：
    1. 获取基础输出目录 base_output_dir (来自 UI 或 -o 参数)。
    2. 根据需要创建子目录，如 ts_output = os.path.join(base_output_dir, "output", "ts") , lua_output = os.path.join(base_output_dir, "output", "lua") 等。
    3. Ini->Excel 的输出是 .xlsx 文件，建议放在 excel_output = os.path.join(base_output_dir, "output", "excel") 。
  - 需要更新 `ensure_directory` 或相关逻辑，确保这些 output/ts , output/lua , output/ini , output/excel 子目录在写入前被创建。
- 并发执行:
  - “同时勾选多个功能进行转换，将同时执行” - 这应理解为：对于 同一个输入的 Excel 文件 ，如果勾选了 TS、Lua 和 Ini，那么程序应该一次性读取该 Excel，然后分别生成对应的 TS、Lua 和 Ini 文件。这是合理的优化。
  - Ini->Excel 的执行是完全独立的流程。
- 核心实现模块:
  - 需要创建新的 Python 模块来实现具体转换逻辑，例如：
    - src/core/lua_generator.py : 从解析后的 Excel 数据生成 Lua。
    - src/core/ini_generator.py : 从解析后的 Excel 数据生成 Ini。
    - src/core/ini_parser.py : 解析 Ini 文件。
    - src/core/excel_writer.py (或类似名称): 根据解析后的 Ini 数据生成 Excel 文件 (可能需要 openpyxl 或 pandas 库)。
  - 需要考虑 Lua 和 Ini 的生成是否也需要模板文件（类似 else/模版/生成 ts 模版/数据模版.ts ）。

3. 框架修改:

- UI ( main_window.py ):
  - 输入区域:
    - 保留现有的 "输入目录" (用于 Excel)。
    - 新增: "INI 输入" 区域（标签、LineEdit、浏览按钮），用于选择 Ini 文件或目录。此区域可以默认隐藏，仅在勾选了 "Ini -> Excel" 功能时显示。
  - 输出区域:
    - "输出目录" 的标签可以改为 "基础输出目录"，使其含义更清晰。
  - 功能选择区域:
    - 新增: 一个 QGroupBox (例如，标题为 "转换选项")，包含以下 QCheckBox ：
      - "Excel -> TypeScript" (可以默认勾选)
      - "Excel -> Lua"
      - "Excel -> Ini"
      - "Ini -> Excel"
  - 交互逻辑: 需要添加逻辑，当 "Ini -> Excel" 复选框状态改变时，控制 "INI 输入" 区域的显隐。
- 配置管理 ( config_manager.py , config.json ):
  - 新增配置项:
    - convert_to_lua: bool (默认为 False )
    - convert_to_ini: bool (默认为 False )
    - convert_ini_to_excel: bool (默认为 False )
    - ini_input_path: str (默认为 "" )
  - 更新:
    - `ConfigManager.DEFAULT_CONFIG` 需要包含这些新项。
    - `MainWindow.load_config` 和 `MainWindow.save_config` 需要读取和保存这些新配置项对应的 UI 控件状态。
    - `ConfigDialog` (高级设置) 可能暂时不需要修改，除非有与新功能相关的全局高级设置。
- 后台任务 ( conversion_worker.py ):
  - **init** 需要接收更完整的 config 对象，包含所有输入/输出路径和所有转换类型的启用状态。
  - run 方法需要重构：
    - 首先检查 config 中启用的 Excel->\* 转换类型。如果至少启用了一种，则查找 Excel 文件并遍历它们。对于每个 Excel 文件，调用相应的解析器和生成器（TS, Lua, Ini）。
    - 然后检查 config 中是否启用了 Ini->Excel。如果启用了，则查找 Ini 文件（根据 ini_input_path ），遍历它们，调用 Ini 解析器和 Excel 生成器。
  - 进度报告 ( progress_updated ) 需要能反映总进度，可能需要计算 Excel 文件数 + Ini 文件数（如果 Ini->Excel 启用）。
- 文件处理 ( file_utils.py ):
  - 新增: 查找 .ini 文件的方法，类似于现有查找 Excel 文件的方法。
  - 修改/替换: `create_output_path` 可能需要修改或被新的逻辑替代，以便能根据目标类型（ts, lua, ini, excel）和基础输出目录正确生成完整的输出文件路径（包括创建 output/ts 等子目录）。
