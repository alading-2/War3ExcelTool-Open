# INI 文件解析功能需求

## 核心目标

将特定格式的 INI 文件解析成 Python 的数据结构（字典列表），以便后续处理（例如，转换为 Excel）。

## 解析规则

1. **基本单位:** INI 文件中的每一个 **节 (Section)**，例如 `[h000]`，代表一个独立的数据记录。
2. **输出结构:** 每个 Section 应被解析成一个 Python **字典 (Dictionary)**。
3. **ID 映射:** Section 的名称（方括号内的部分，如 `h000`）需要被提取出来，并作为该 Section 对应字典中 `"id"` 键的值。

   - 示例：`[h000]` -> `{"id": "h000", ...}`

4. **键值对映射:** Section 内部的每一行 `key=value` 对应字典中的一个键值对。
5. **数据类型处理 (重要):**

   - **无需类型转换:** 所有从 INI 文件读取的值 (value) 都必须**保持为字符串类型**，原样存储在字典中。不进行任何自动的整数、浮点数、布尔值等类型转换。
   - **示例:**
     - `_parent="hpea"` 解析为 `{"_parent": "hpea"}` (值是字符串 `"hpea"`)
     - `collision=0` 解析为 `{"collision": "0"}` (值是字符串 `"0"`)
     - `regenType=""` 解析为 `{"regenType": ""}` (值是空字符串 `""`)

6. **整体输出:** 整个 INI 文件最终应被解析成一个包含多个字典的 **列表 (List)**，列表中的每个字典代表 INI 文件中的一个 Section。

## 实现建议

- **推荐工具:** 使用 Python 内建的 `configparser` 模块来读取 INI 文件的基本结构（获取 Sections 和每个 Section 内的键值对）。
- **处理流程:**
  1. 初始化一个空的列表 `result_list`。
  2. 使用 `configparser` 读取 INI 文件。
  3. 遍历 `configparser` 对象的所有 `sections()`。
  4. 对于每个 `section_name`:
     - 创建一个新的空字典 `section_dict`。
     - 将 `"id"` 键添加到 `section_dict`，其值为当前的 `section_name` (字符串)。
     - 遍历该 `section_name` 下的所有键值对 (`config[section_name].items()`)。
     - 将每个键 (key) 和对应的值 (value) 添加到 `section_dict` 中（确保值保持为字符串）。
     - 将 `section_dict` 追加到 `result_list`。
  5. 返回 `result_list`。

## 与 JSON 的关系

这种生成的 Python 列表嵌套字典的结构，与 JSON 格式非常兼容。如果需要将结果输出为 JSON 字符串，可以使用 Python 的 `json` 模块：

```python
import json
import configparser

def parse_ini_to_list(ini_file_path):
    config = configparser.ConfigParser()
    # 读取INI文件，保留原始大小写
    config.optionxform = str
    try:
        # 指定编码以支持中文等字符
        config.read(ini_file_path, encoding='utf-8')
    except Exception as e:
        print(f"Error reading INI file {ini_file_path}: {e}")
        return []

    result_list = []
    for section_name in config.sections():
        section_dict = {"id": section_name}
        for key, value in config.items(section_name):
            # 值保持为字符串
            section_dict[key] = value
        result_list.append(section_dict)
    return result_list

# 示例用法
# parsed_data = parse_ini_to_list("path/to/your/file.ini")
# if parsed_data:
#     # 转换为格式化的 JSON 字符串 (可选)
#     json_output = json.dumps(parsed_data, indent=4, ensure_ascii=False)
#     print(json_output)
```
