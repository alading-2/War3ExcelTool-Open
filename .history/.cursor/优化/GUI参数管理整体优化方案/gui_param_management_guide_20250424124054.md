# GUI 参数管理整体优化方案总结（AI 参考文档）

## 1. 设计目标

本方案旨在实现 ExcelToTypescript 项目中 GUI 参数的统一、规范、高效管理，解决参数分散、同步不及时、界面混乱等问题，提升用户体验和代码可维护性。

## 2. 参数分类原则

- **功能参数**：直接影响主流程和核心功能（如"是否转换 TS"、"是否解析 w3x"等），只出现在主界面，便于用户快速操作。
- **辅助参数**：影响细节或高级行为（如"递归处理"、"日志级别"、"字体大小"等），只出现在"高级设置"或 config_dialog.py，不在主界面展示。
- 分类标准：功能参数与用户主要操作强相关，辅助参数为可选项或进阶设置。

## 3. ConfigManager 的作用

- 负责加载、保存、同步所有参数，支持从 cfg 文件热加载。
- 保证参数在配置文件、GUI 界面、代码逻辑三者间实时同步，防止丢失或不同步。
- 提供类型转换、默认值处理、参数校验等功能。

## 4. GUI 与配置文件的联动

- 所有参数变更（无论来自界面还是配置文件）都要通过 ConfigManager 统一管理。
- GUI 界面初始化时从 ConfigManager 加载参数，用户修改后实时写回。
- 配置文件变更时，ConfigManager 负责通知 GUI 界面刷新参数。

## 5. 自动化控件生成

- 根据参数类型（bool、int、str 等）和分组（功能/辅助）自动生成合适的控件（如复选框、下拉框、输入框等）。
- 控件布局根据参数分组自动调整，提升界面美观和可用性。
- 控件与 ConfigManager 绑定，保证参数变更实时同步。

## 6. 用户交互与规则约束

- 设计或调整参数管理方案时，必须充分征求用户意见，未经用户确认不得擅自更改参数分组或添加命令行参数。
- 严格遵循"用户未指定不主动添加命令行参数"的规则，避免参数膨胀和界面混乱。

## 7. 常见错误与规避

- 参数分类不清、同步遗漏、命名不规范、注释不详细、未征求用户意见、控件生成逻辑不健全、未查阅官方文档等。
- 详见 08-cursorrules.mdc 中的"GUI 参数管理常见错误与规避规则"部分。

## 8. 典型调用流程（AI 开发参考）

1. 新增或调整参数时，先明确其分类（功能/辅助），并在 ConfigManager、GUI 界面、配置文件三方同步。
2. 设计 GUI 控件时，查阅 PyQt 官方文档，按参数类型和分组自动生成。
3. 变更参数管理方案前，主动与用户沟通确认。
4. 代码开发和优化时，优先查阅本指南和 08-cursorrules.mdc，避免重复犯错。

---

> 本文档为 AI 开发者在处理 GUI 参数管理相关功能时的参考指南，建议每次生成相关代码前先查阅本文件和 08-cursorrules.mdc，确保实现方案规范、健壮、易维护。
