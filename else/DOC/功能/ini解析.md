iniparse：解析 ini 文件数据

war3ini 示例：

[A007]

DataF = {

"ancestralspirit",

"ancestralspirit",

"ancestralspirit",

}

-- 影响区域

Area = {1000.0, 1000.0, 1000.0}

-- 提示工具 - 普通

Tip = {

"横贯四方[|cffffcc00R|r] - [|cffffcc00 等级 1|r]",

"横贯四方[|cffffcc00R|r] - [|cffffcc00 等级 2|r]",

"横贯四方[|cffffcc00R|r] - [|cffffcc00 等级 3|r]",

}

-- 提示工具 - 学习 - 扩展

Researchubertip = [=[

斧王横扫四方，对 1000 范围内敌人造成 3 次范围伤害。

|cffffcc00 等级 1|r - 总共造成 500+5× 力量值伤害

|cffffcc00 等级 2|r - 总共造成 1000+5× 力量值伤害

|cffffcc00 等级 3|r - 总共造成 1500+5× 力量值伤害

|n|cff99ccff 作用范围：|r1000

|cff99ccff 冷却时间：|r70/60/50

|cff99ccff 魔法消耗：|r150/300/450]=]

Ubertip = {

[=[

斧王横扫四方，对 1000 范围内敌人造成 3 次范围伤害。

|n|cff99ccff 伤害：|r500+5× 力量值

|cff99ccff 作用范围：|r1000

|cff99ccff 冷却时间：|r70 秒

|cff99ccff 魔法消耗：|r150]=],

[=[

斧王横扫四方，对 1000 范围内敌人造成 3 次范围伤害。

|n|cff99ccff 伤害：|r1000+5× 力量值

|cff99ccff 作用范围：|r1000

|cff99ccff 冷却时间：|r60 秒

|cff99ccff 魔法消耗：|r300]=],

[=[

斧王横扫四方，对 1000 范围内敌人造成 3 次范围伤害。

|n|cff99ccff 伤害：|r1500+5× 力量值

|cff99ccff 作用范围：|r1000

|cff99ccff 冷却时间：|r50 秒

|cff99ccff 魔法消耗：|r450]=],

}

-- 基础命令 ID

\_parent = "ANcl"

-- 效果 - 施法动作

Animnames = "Attack Walk Stand Spin"

要求：

0.--以开头的是注释，改行不读取

1.用{}表示多项，里面用逗号,隔开

2.用[=[...]=]表示多行字符串

3.我希望用正则表达式的方式来实现，要求：简洁实用，不要写一大堆代码

4.解析的结果是以下的字典，大致就是原样输出：

{'A007'={

'DataF'= '{"ancestralspirit","ancestralspirit","ancestralspirit",}',

'Area' = '{1000.0, 1000.0, 1000.0}',

'Researchubertip' =

"""斧王横扫四方，对 1000 范围内敌人造成 3 次范围伤害。

|cffffcc00 等级 1|r - 总共造成 500+5× 力量值伤害

|cffffcc00 等级 2|r - 总共造成 1000+5× 力量值伤害

|cffffcc00 等级 3|r - 总共造成 1500+5× 力量值伤害

|n|cff99ccff 作用范围：|r1000

|cff99ccff 冷却时间：|r70/60/50

|cff99ccff 魔法消耗：|r150/300/450""",

'Ubertip' = """{

[=[

斧王横扫四方，对 1000 范围内敌人造成 3 次范围伤害。

|n|cff99ccff 伤害：|r500+5× 力量值

|cff99ccff 作用范围：|r1000

|cff99ccff 冷却时间：|r70 秒

|cff99ccff 魔法消耗：|r150]=],

[=[

斧王横扫四方，对 1000 范围内敌人造成 3 次范围伤害。

|n|cff99ccff 伤害：|r1000+5× 力量值

|cff99ccff 作用范围：|r1000

|cff99ccff 冷却时间：|r60 秒

|cff99ccff 魔法消耗：|r300]=],

[=[

斧王横扫四方，对 1000 范围内敌人造成 3 次范围伤害。

|n|cff99ccff 伤害：|r1500+5× 力量值

|cff99ccff 作用范围：|r1000

|cff99ccff 冷却时间：|r50 秒

|cff99ccff 魔法消耗：|r450]=],

}"""

}

}

# War3 INI 解析器实现指南

## 输入格式特点

- 节点使用 [节点名] 表示
- 键值对使用 key = value 格式
- 注释以 -- 开头
- 数组使用 {} 包裹，元素用逗号分隔
- 多行字符串使用 [=[...]=] 格式
- 字符串可以用 "" 或 '' 包裹

## 解析要求

1. 将注释行（以 -- 开头）忽略或转换为标准注释格式
2. 正确识别节点和键值对关系
3. 保留数组和多行字符串的原始格式
4. 输出结构化的字典/对象
5. 处理嵌套结构（如数组中包含多行字符串）

## 实现建议

- 使用正则表达式识别不同类型的行
- 使用状态机跟踪解析上下文（节点内/多行字符串内/数组内）
- 对于多行结构，需要累积内容直到找到结束标记
- 处理转义字符和特殊格式

## 示例输入输出

输入: [A007] 节点包含各种格式的键值对
输出: {'A007': {...}} 包含所有解析后的键值对
